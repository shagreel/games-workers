var p=(a={})=>{let{origins:i=["*"],maxAge:c,methods:l=["GET"],headers:h={}}=a,n,t={"content-type":"application/json","Access-Control-Allow-Methods":l.join(", "),...h};return c&&(t["Access-Control-Max-Age"]=c),{corsify:e=>{if(!e)throw new Error("No fetch handler responded and no upstream to proxy to specified.");let{headers:o,status:s,body:r}=e;if(s===101)return e;let d=Object.fromEntries(o);return d["access-control-allow-origin"]||[301,302,308].includes(s)?e:new Response(r,{status:s,headers:{...d,...t,...n,"content-type":o.get("content-type")}})},preflight:e=>{let o=[...new Set(["OPTIONS",...l])],s=e.headers.get("origin");if(n=(i.includes(s)||i.includes("*"))&&{"Access-Control-Allow-Origin":s},e.method==="OPTIONS"){if(e.headers.get("Origin")!==null&&e.headers.get("Access-Control-Request-Method")!==null&&e.headers.get("Access-Control-Request-Headers")!==null){let r={...t,"Access-Control-Allow-Methods":o.join(", "),"Access-Control-Allow-Headers":e.headers.get("Access-Control-Request-Headers"),...n};return new Response(null,{headers:r})}return new Response(null,{headers:{Allow:o.join(", ")}})}}}};export{p as createCors};
